<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.sajo.god.member.mapper">
	
<!-- gNum의 최대값 -->
<select id="maxNum" resultType="int">
	select nvl(max(gNum),0) from group	
</select>

<!-- 데이터 입력 -->
<insert id="insertData" parameterType="com.sajo.god.member.BoardDTO">
	insert into group(gNo,gNum,gHitCount,mId,gSubject,gImg1,gImg2,gImg3,gImg4,
	gCount,gCreated,boardName) values (#{gNo},#{gNum},0,#{mId},#{gSubject},#{gImg1},#{gImg2},#{gImg3},#{gImg4},
	#{gCount},sysdate,#{boardName})
</insert>

<!-- 전체데이터 갯수 -->
<select id="getDataCount" parameterType="hashMap" resultType="int">
	select nvl(count(*),0) from group
	where ${searchKey} like '%' || #{searchValue} || '%'
</select>

<!-- 모든 데이터 -->
<select id="getLists" parameterType="hashMap" resultType="com.sajo.god.member.BoardDTO">
	select * from (
	select rownum rnum, data.* from(
	select gNum,name,gSubject,gHitCount,to_char(created,'YYYY-MM-DD') gCreated
	from group where ${searchKey} like '%' || #{searchValue} || '%'
	order by gNum desc) data)
<![CDATA[
	where rnum>=#{start} and rnum<=#{end}
]]>
</select>

<!-- 조회수 수정 -->
<update id="updateHitCount" parameterType="int">
	update group set gHitCount=gHitCount+1 where gNum=#{gNum}
</update>

<!-- 한개의 데이터 -->
<select id="getReadData" parameterType="int" resultType="com.sajo.god.member.BoardDTO">
	select num,name,pwd,email,subject,content,hitCount,created from group where gNum=#{gNum}
</select>

<!-- 데이터 수정 -->
<update id="updateData" parameterType="com.sajo.god.member.BoardDTO">
	update group set name=#{name},pwd=#{pwd},email=#{email},gSubject=#{gSubject},
	content=#{content} where gNum=#{gNum}
</update>

<!-- 데이터 삭제 -->
<delete id="deleteData" parameterType="int">
	delete group where gNum=#{gNum}
</delete>
<!-- 
insert into group(gNo,gNum,gHitCount,mId,gSubject,gImg1,gImg2,gImg3,gImg4,
=======

 insert into group(gNo,gNum,gHitCount,mId,gSubject,gImg1,gImg2,gImg3,gImg4,
	gCount,gCreated,boardName) values (#{gNo},#{gNum},0,#{mId},#{gSubject},#{gImg1},#{gImg2},#{gImg3},#{gImg4},
	#{gCount},sysdate,#{boardName})
 -->
	
</mapper>